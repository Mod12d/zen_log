---
title: "react-force-graphã‚’å®Ÿè£…ã™ã‚‹éš›ã«è©°ã¾ã£ãŸç‚¹(TypeScript)"
emoji: "ğŸ£"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [neo4j, react-force-graph] 
published: true
---

## å‹•æ©Ÿ

ä»¥ä¸‹ã®è¨˜äº‹ã‚’è¦‹ã¦ã€
neo4jã®ã‚µãƒ³ãƒ—ãƒ«DBã‹ã‚‰ã€ãƒãƒ¼ãƒ‰(ç‚¹ï¼‰ï¼‰ã¨ã‚¨ãƒƒã‚¸ï¼ˆè¾ºï¼‰ã‚’è¡¨ç¤ºã™ã‚‹
è¨˜äº‹ä¸­ã®ã‚³ãƒ¼ãƒ‰ã¯javascriptãªã®ã§ã€typescriptã§æ›¸ãã¨ï¼’ã¤ã®ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã™ã‚‹

https://lyonwj.com/blog/graph-visualization-with-graphql-react-force-graph


### ãƒã‚¤ãƒ³ãƒˆâ‘  Nodeã®å‹ã®æ‹¡å¼µ

Javascriptã§æ›¸ã‹ã‚ŒãŸå‚è€ƒã®ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã€
ã¾ãšã€nodeã®å‹ã‚’æ‹¡å¼µã™ã‚‹ã€‚

```typescript
type UserNode = NodeObject & {
  name?: string;
  imgUrl?: string;
  imgLoaded?: boolean;
  img?: HTMLImageElement;
};

```


### ãƒã‚¤ãƒ³ãƒˆâ‘¡ è¾ºã‚’ã¤ãªã’ã‚‹ãŸã‚ã«

è¾ºã‚’linksã®é…åˆ—ã«ç¹‹ã’ã‚‹å¿…è¦ãŒã‚ã‚‹
ç§ã®å ´åˆã¯idã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã§ãŠèŒ¶ã‚’æ¿ã—ã¦ã„ã‚‹

```typescript

  const links: LinkObject[] = [];

  data.users.forEach((a) => {
    nodes.push({
      id: a?.id,
      name: a?.name,
      imgUrl: a?.profile_image_url,
    });
  });
  for (let i = 1; i < data.users.length; i++) {
    links.push({
      source: data.users[i - 1]?.id,
      target: data.users[i]?.id,
    });
  }
```

â‘ ã€â‘¡ã®æº–å‚™ãŒã§ãã‚‹ã¨ReactForceã‚°ãƒ©ãƒ•ã§`imageUrl`ä»–ã€
æ‹¡å¼µã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒåˆ©ç”¨ã§ãã‚‹


```typescript

<NoSSRForceGraph
 nodeCanvasObject={(node: UserNode, ctx) => {
            const size = 12;
            const img = new Image();
            img.src = node.imgUrl;
 
```

ã‚¤ãƒ¡ãƒ¼ã‚¸

![](/images/neo4j-sample.png)


ãŠã¾ã‘ï¼š
`nodeCanvasObject`ã§ã‚°ãƒ©ãƒ•ãŒä½œæˆã§ããŸã‚‰ã€CRUDã‚’ã—ãŸã„ã€‚
ä»¥ä¸‹ã®ã‚µãƒ³ãƒ—ãƒ«ãŒå‚è€ƒã«ãªã‚Šãã†
https://vasturiano.github.io/force-graph/example/build-a-graph/
